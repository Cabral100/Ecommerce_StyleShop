{% extends "_layout.html" %}
{% block title %}Seu Carrinho - StyleShop{% endblock %}
{% block content %}
<section class="py-16">
    <div class="container mx-auto px-6 max-w-4xl">
        <h1 class="heading text-4xl text-center mb-12">Seu Carrinho</h1>
        
        {% if produtos %}
        <div class="bg-white border rounded-lg p-6">
            <!-- Itens do Carrinho -->
            {% for produto in produtos %}
            <div class="flex items-center justify-between py-4 border-b">
                <div class="flex items-center space-x-6">
                    <!-- ESTA É A LINHA QUE FOI CORRIGIDA -->
                    <img src="{{ url_for('static', filename='uploads/' + produto.imagens[0]) if produto.imagens else 'https://via.placeholder.com/112x144?text=STYLE' }}" alt="{{ produto.nome }}" class="w-28 h-36 object-cover rounded-md">
                    <div>
                        <h2 class="font-semibold text-lg">{{ produto.nome }}</h2>
                        <p class="text-zinc-600">Cor: {{ produto.color }}</p>
                        <p class="text-zinc-600">Tamanho: {{ produto.size }}</p>
                        <a href="{{ url_for('routes.remove_from_cart', item_id=produto.item_id) }}" class="text-red-500 text-sm hover:underline mt-2 inline-block">Remover</a>
                    </div>
                </div>
                <div class="text-right">
                    <p class="font-semibold">R$ {{ "%.2f"|format(produto.preco|float) }}</p>
                    <p class="text-zinc-500">Qtd: {{ produto.quantity }}</p>
                </div>
            </div>
            {% endfor %}

            <!-- Total e Checkout -->
            <div class="mt-6 flex justify-end items-center">
                <span class="text-xl font-bold">Total: R$ {{ "%.2f"|format(total) }}</span>
                <form action="{{ url_for('routes.checkout') }}" method="post" class="ml-6">
                    <button type="submit" class="bg-black text-white font-semibold py-3 px-8 rounded-md hover:bg-zinc-800 transition">
                        Finalizar Compra
                    </button>
                </form>
            </div>
        </div>
        {% else %}
        <div class="text-center py-20">
            <h2 class="text-2xl font-semibold mb-2">Seu carrinho está vazio.</h2>
            <p class="text-zinc-600 mb-6">Explore nossos produtos e encontre algo que você ame.</p>
            <a href="{{ url_for('routes.products') }}" class="bg-black text-white font-semibold py-3 px-8 rounded-md hover:bg-zinc-800 transition">
                Ver Produtos
            </a>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}